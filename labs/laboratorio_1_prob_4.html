<!DOCTYPE html>
<!--[if lt IE 7]>    <html lang="es" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>       <html lang="es" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>       <html lang="es" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="es" class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport">
    <meta name="author" content="Martin Josemaria Vuelta Rojas">
    <meta name="description" content="Web para el curso de procesamiento de datos digitales">

    <meta name="msapplication-tap-highlight" content="no">
    <meta name="msapplication-TileColor" content="#00000">
    <meta name="msapplication-TileImage" content="../static/img/favicon.png">
    <meta name="theme-color" content="#000000">


    <title>Procesamiento de Datos Digitales</title>

    <link rel="apple-touch-icon-precomposed" type="image/x-icon" href="../static/img/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="../static/img/favicon.png"/>

    <link rel="stylesheet" href="../static/css/normalize.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="../static/css/font-awesome.min.css">
    <link rel="stylesheet" href="../static/css/shCore.css">
    <link rel="stylesheet" href="../static/css/shThemeDefault.css">
    <link rel="stylesheet" href="../static/css/materialize.css">
    <link rel="stylesheet" href="../static/css/extensions.css">
    <link rel="stylesheet" href="../static/css/overrides.css">
    <link rel="stylesheet" href="../static/css/helpers.css">
    <link rel="stylesheet" href="../static/css/pdd.css">
    <style>
        html, body {
            height: 100vh;
        }
        #map-wrapper{
            position: relative;
            height: 100%;
            width: 100%;
        }

        #map {
            height: 100%;
        }

        #floating-panel {
            position: absolute;
            bottom: 24px;
            left: 10px;
            z-index: 5;
            width: 300px;
        }
    </style>
  </head>

  <body>
    <ul id="sidenav" class="waves-effect side-nav fixed light-color table-of-contents">
      <li class="waves-effect waves-light dark-color s-mar-0 s-pad-0">
        <a href="../" class=" s-mar-0 s-pad-0">
          <h4 class="grey-text text-lighten-5 text700 s-mar-0 s-pad-0 center-align">PDD</h4>
        </a>
      </li>
      <li><a href="../" class="active"><i class="fa fa-fw fa-home"></i>Inicio</a></li>
      <li><a href="./laboratorio1">Regresar</a></li>
    </ul>

    <header class="dark-color navbar-fixed">
      <nav class="transparent waves-effect waves-light">
        <div class="container">
          <div class="nav-wrapper">
            <a href="javascript:void(0);" data-activates="sidenav" class="button-collapse left s-pad-0">
              <i class="material-icons">menu</i>
            </a>

            <a href="laboratorio_1.html" class="brand-logo">
              <span class="text300">
                Laboratorio 1
                <small class="hide-on-small-only"><small>(Solución)</small></small>
                <small class="hide-on-med-and-up"><small>(Sol.)</small></small>
              </span>
            </a>
          </div>
        </div>
      </nav>
    </header>

    <main>
      <div id="map-wrapper">
        <div id="map"></div>
        <div id="floating-panel" class="s-mar-0">
          <div class="card s-mar-0">
            <div class="card-content s-mar-0">
              <div class="row s-mar-0">
                <h5>Cálculo de distancias</h5>
                <p><strong><i class="fa fa-fw fa-map-marker prefix"></i>Origen</strong></p>
                <div class="input-field deep-purple-focus col s6">
                  <input id="latitude1" type="number" readonly class="deep-purple-focus">
                  <label class="active" for="latitude1">Latitud [°]</label>
                </div>
                <div class="input-field deep-purple-focus col s6">
                  <input id="longitude1" type="number" readonly class="deep-purple-focus">
                  <label class="active" for="longitude1">Longitud [°]</label>
                </div>

                <p><strong><i class="fa fa-fw fa-map-marker prefix"></i>Destino</strong></p>
                <div class="input-field deep-purple-focus col s6">
                  <input id="latitude2" type="number" readonly class="deep-purple-focus">
                  <label class="active" for="latitude2">Latitud [°]</label>
                </div>
                <div class="input-field deep-purple-focus col s6">
                  <input id="longitude2" type="number" readonly class="deep-purple-focus">
                  <label class="active" for="longitude2">Longitud [°]</label>
                </div>

                <p><strong><i class="fa fa-fw fa-expand prefix"></i>Distancia [km]</strong></p>
                <div class="input-field deep-purple-focus col s12">
                  <input id="distance" type="number" class="deep-purple-focus">
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </main>

    <footer class="page-footer gray-gradient s-mar-t0">
      <div class="footer-copyright transparent">
        <div class="container center base-text">
        © 2015 FENLAB - FCF - UNMSM
        </div>
      </div>
    </footer>
    <script>
        var marker1, marker2;
        var poly, geodesicPoly;

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 3,
                center: {
                    lat: 34,
                    lng: -40.605
                }
            });

            map.controls[google.maps.ControlPosition.TOP_CENTER].push(
                document.getElementById('info'));

            marker1 = new google.maps.Marker({
                map: map,
                draggable: true,
                position: {
                    lat: 40.78139796148296,
                    lng: -73.96668954467765
                }
            });

            marker2 = new google.maps.Marker({
                map: map,
                draggable: true,
                position: {
                    lat: -12.067156558830048,
                    lng: -77.0886956434249
                }
            });

            var bounds = new google.maps.LatLngBounds(
                marker1.getPosition(), marker2.getPosition());

            // map.fitBounds(bounds);

            map.setCenter({
              lat: (marker1.position.lat() + marker2.position.lat())*0.5,
              lng: (marker1.position.lng() + marker2.position.lng())*0.5
            })

            google.maps.event.addListener(marker1, 'position_changed', update);
            google.maps.event.addListener(marker2, 'position_changed', update);

            poly = new google.maps.Polyline({
                strokeColor: '#FF0000',
                strokeOpacity: 1.0,
                strokeWeight: 3,
                map: map,
            });

            geodesicPoly = new google.maps.Polyline({
                strokeColor: '#CC0099',
                strokeOpacity: 1.0,
                strokeWeight: 3,
                geodesic: true,
                map: map
            });

            var labels = document.getElementsByTagName('label')
            for(var i = 0; i < labels.length; i++){
              if(labels[i].parentElement.classList.contains('input-field')){
                labels[i].classList.add('active')
              }
            }

            update();
        }

        function update() {
            var path = [marker1.getPosition(), marker2.getPosition()];
            poly.setPath(path);
            geodesicPoly.setPath(path);
            var distance = google.maps.geometry.spherical.computeDistanceBetween(path[0], path[1]);
            document.getElementById('distance').value = (distance/1000).toString();
            document.getElementById('latitude1').value = path[0].lat();
            document.getElementById('longitude1').value = path[0].lng();
            document.getElementById('latitude2').value = path[1].lat();
            document.getElementById('longitude2').value = path[1].lng();
        }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?signed_in=true&libraries=geometry&callback=initMap" async defer></script>
    <!-- script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script -->
    <script type="text/javascript" charset="utf-8" src="../static/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" charset="utf-8" src="../static/js/modernizr.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="../static/js/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="../static/js/jquery.smoothState.js"></script>
    <script type="text/javascript" charset="utf-8" src="../static/js/attrchange.js"></script>
    <script type="text/javascript" charset="utf-8" src="../static/js/materialize.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="../static/js/shCore.js"></script>
    <script type="text/javascript" charset="utf-8" src="../static/js/shBrushJScript.js"></script>
    <script type="text/javascript" charset="utf-8" src="../static/js/shBrushMatlab.js"></script>
    <script type="text/javascript" charset="utf-8" src="../static/js/shBrushPlain.js"></script>
    <script type="text/javascript" charset="utf-8" src="../static/js/pdd.js"></script>
  </body>
</html>
